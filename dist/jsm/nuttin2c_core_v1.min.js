import{ContainerUrl as t,ContainerHttpClient as e,ContainerUploadData as n,ContainerElementUtils as i,ContainerElement as s,ContainerText as r,ContainerWindow as a,ContainerDownload as l}from"./containerbridge_v1.js";import{StringUtils as o,List as c,Logger as h,ArrayUtils as u,Map as d,Method as p,PropertyAccessor as m,MapUtils as g,RadixUtils as f,MacUtils as E}from"./coreutil_v1.js";import{InjectionPoint as y,MindiInjector as w,SingletonConfig as S,PrototypeConfig as b,InstancePostConfigTrigger as v,MindiConfig as A,ConfigAccessor as T}from"./mindi_v1.js";import{XmlElement as M,XmlCdata as x,XmlAttribute as C,DomTree as R}from"./xmlparser_v1.js";class _{runModule(t){}}class I{constructor(t,e,n=null,i=null,s=null,r=null){this.protocolString=t,this.hostString=e,this.portString=n,this.pathValueArray=i,this.queryParamMap=s,this.anchorString=r,this.pathValueArray||(this.pathValueArray=new Array),this.queryParamMap||(this.queryParamMap=new Map)}get protocol(){return this.protocolString}get host(){return this.hostString}get port(){return this.portString}get pathsList(){return this.pathValueList}get anchor(){return this.anchorString}get parameterMap(){return this.parameterValueMap}getPathPart(t){return this.pathValueList.get(t)}replacePathValue(t,e){let n=0;for(;n<this.pathValueArray.length;){if(o.nonNullEquals(t,this.pathValueArray[n]))return this.pathValueArray[n]=e,this;n++}return this}get path(){let t="/",e=!0;return this.pathValueList.forEach((n=>{e||(t+="/"),t+=n,e=!1}),this),t}toString(){var t="";if(null!==this.protocol&&(t=t+this.protocol+"//"),null!==this.host&&(t+=this.host),null!==this.port&&(t=t+":"+this.port),this.pathValueArray.forEach((e=>{t=t+"/"+e})),this.queryParamMap.size>0){const e=new Array;this.queryParamMap.forEach(((t,n)=>{t.forEach((t=>(null!==t?e.push(n+"="+t):e.push(n),!0)))})),e.length>0&&(t=t+"?"+e.join("&"))}return null!==this.anchor&&(t=t+"#"+this.anchor),t}}class P{static parse(t){if(null===t)return null;const e=P.parseProtocol(t),n=P.parseHost(t),i=P.parsePort(t),s=P.parsePathArray(t),r=P.parseQueryParam(t),a=P.parseBookmark(t);return new I(e,n,i,s,r,a)}static parseProtocol(t){if(null===t)return null;if(-1===t.indexOf("//"))return null;const e=t.split("//")[0];return":"!==e[e.length-1]?null:e}static parseHost(t){if(null===t)return null;if(-1===t.indexOf("://"))return null;let e=t.split("://")[1];-1!==e.indexOf("/")&&(e=e.split("/")[0]);let n=e;return-1!==e.indexOf(":")&&(n=e.split(":")[0]),n}static parsePort(t){if(null===t)return null;if(-1===t.indexOf("://"))return null;let e=t.split("://")[1];return-1!==e.indexOf("/")&&(e=e.split("/")[0]),-1===e.indexOf(":")?null:Number.parseInt(e.split(":")[1])}static parsePathArray(t){if(null===t)return null;-1!==t.indexOf("://")&&(t=t.split("://")[1]),-1!==t.indexOf("/")&&(t=t.substring(t.indexOf("/"))),-1!==t.indexOf("?")?t=t.split("?")[0]:-1!==t.indexOf("#")&&(t=t.split("#")[0]),t.startsWith("/")&&(t=t.substring(1));const e=t.split("/"),n=new Array;return e.forEach((t=>{n.push(decodeURI(t))})),n}static parseQueryParam(t){if(null===t)return null;if(-1!==t.indexOf("://")&&(t=t.split("://")[1]),-1!==t.indexOf("/")&&(t=t.substring(t.indexOf("/"))),-1===t.indexOf("?"))return null;let e=t.split("?")[1];-1!==e.indexOf("#")&&(e=e.split("#")[0]);const n=new Map;return e.split("&").forEach((t=>{let e=null,i=null;-1!==t.indexOf("=")?(e=t.split("=")[0],i=t.split("=")[1]):(e=t,i=null),e=decodeURI(e),i=decodeURI(i),n.get(e)||n.set(e,new Array),n.get(e).push(i)})),n}static parseBookmark(t){if(null===t)return null;if(-1!==t.indexOf("://")&&(t=t.split("://")[1]),-1!==t.indexOf("/")&&(t=t.substring(t.indexOf("/"))),-1!==t.indexOf("?")&&(t=t.split("?")[1]),-1===t.indexOf("#"))return null;return t.split("#")[1]}static determineProtocol(t){let e=t.string;if(!e)return null;let n=e;if(-1===e.indexOf("//"))return null;let i=e.split("//");return-1!==i[0].indexOf("/")?null:(n=i[0],1==i.length?t.string=null:t.string=e.replace(i[0]+"//",""),n)}static determineHostAndPort(t){let e=t.string;if(!e)return null;let n=e,i=null;return-1!==n.indexOf("/")&&(n=n.split("/")[0],i=e.replace(n+"/","")),t.string=i,n}static extractHost(t){return t?-1===t.indexOf(":")?t:t.split(":")[0]:null}static extractPort(t){return t?-1===t.indexOf(":")?null:t.split(":")[1]:null}static determinePath(t){let e=t.string;if(!e)return new c;let n=e;if(-1!==n.indexOf("?")){let e=n.split("?");e.length>1&&(t.string=n.substring(n.indexOf("?"))),n=e[0]}else if(-1!==n.indexOf("#")){let e=n.split("#");e.length>1&&(t.string=n.substring(n.indexOf("#"))),n=e[0]}else t.string=null;n.startsWith("/")&&(n=e.substring(1));const i=new c(n.split("/")),s=new c;return i.forEach((t=>(s.add(decodeURI(t)),!0)),this),s}static determineBookmark(t){let e=t.string;if(!e)return t.string=null,null;let n=e;return-1!==e.indexOf("#")&&(n=e.substring(e.indexOf("#")+1),t.string=null),n}static determineQueryParam(t){let e=t.string;if(!e)return null;let n=e;return-1===e.indexOf("?")?(-1!==n.indexOf("#")&&(t.string=n.substring(n.indexOf("#"))),null):(n=e.substring(e.indexOf("?")+1),t.string=null,-1!==n.indexOf("#")&&(n=n.substring(0,n.indexOf("#")),t.string=n.substring(n.indexOf("#"))),n)}}class L{static replaceUrl(e,n,i){t.replaceUrl(e.toString(),n,i)}static pushUrl(e,n,i){t.pushUrl(e.toString(),n,i)}static currentUrl(){return P.parse(t.currentUrl())}}class N{constructor(){this.protocol=null,this.host=null,this.port=null,this.pathArray=new Array,this.queryParameterMap=null,this.anchor=null}static create(){return new N}withUrl(t){return this.withAllOfUrl(P.parse(t)),this}withRootOfUrl(t){return this.protocol=t.protocol,this.port=t.port,this.host=t.host,this}withPathOfUrl(t){return this.withRootOfUrl(t),this.pathArray=t.pathValueArray,this}withAllOfUrl(t){return this.withPathOfUrl(t),this.queryParameterMap=t.queryParamMap,this.anchor=t.anchor,this}withProtocol(t){return this.protocol=t,this}withPort(t){return this.port=t,this}withHost(t){return this.host=t,this}withPath(t){return this.pathArray=P.parsePathArray(t),this}withAnchor(t){return this.anchor=t,this}withQueryParamString(t,e){return this.queryParameterMap.set(t,[e]),this}withQueryParamArray(t,e){return this.queryParameterMap.set(t,e),this}replacePathValue(t,e){let n=0;for(;n<this.pathArray.length;){if(o.contains(t,this.pathArray[n]))return this.pathArray[n]=this.pathArray[n].replace(t,e),this;n++}return this}build(){return new I(this.protocol,this.host,this.port,this.pathArray,this.queryParameterMap,this.anchor)}}let O=null;class V{constructor(){}static instance(){return O||(O=new V),O}go(e){t.go(e.toString())}back(){t.back()}loadPath(t){const e=L.currentUrl(),n=N.create().withRootOfUrl(e).withPath(t).build();return L.pushUrl(n),n}loadAnchor(t){const e=L.currentUrl(),n=N.create().withRootOfUrl(e).withAnchor(t).build();return L.pushUrl(n),n}}class H{constructor(){this.root=!1,this.trail=null,this.property=null,this.waypoint=null,this.destination=null,this.next=null}}let U=null;class k{constructor(){this.moduleRunner=null}static instance(){return U||(U=new k),U}set(t){this.moduleRunner=t}async load(t){const e=V.instance().loadAnchor(t);return await this.moduleRunner.runModule(e)}}class D{static get(t,n=null,i=1e3,s=!1){const r={headers:D.getHeader(n),method:"GET",mode:"cors",redirect:"follow"};return s?e.download(t.toString(),r,i):e.fetch(t.toString(),r,i)}static post(t,i,s=null,r=null,a=1e3){if(i instanceof n)return e.upload("POST",t,i,s,r,a);const l=D.getHeader(s),o={body:JSON.stringify(i),headers:l,method:"POST",mode:"cors",redirect:"follow"};return e.fetch(t.toString(),o,a)}static put(t,i,s=null,r=null,a=1e3){if(i instanceof n)return e.upload("PUT",t,i,s,r,a);const l=D.getHeader(s),o={body:JSON.stringify(i),method:"PUT",mode:"cors",redirect:"follow",headers:l};return e.fetch(t.toString(),o,a)}static patch(t,n,i=null,s=null,r=1e3){const a=D.getHeader(i),l={body:JSON.stringify(n),method:"PATCH",mode:"cors",redirect:"follow",headers:a};return e.fetch(t.toString(),l,r)}static delete(t,n,i=null,s=null,r=1e3){const a=D.getHeader(i);if(n){const i={body:JSON.stringify(n),method:"DELETE",mode:"cors",redirect:"follow",headers:a};return e.fetch(t.toString(),i,r)}{const n={method:"DELETE",mode:"cors",redirect:"follow",headers:a};return e.fetch(t.toString(),n,r)}}static getHeader(t=null){return t?{"user-agent":"Mozilla/4.0 MDN Example","content-type":"application/json",Authorization:t}:{"user-agent":"Mozilla/4.0 MDN Example","content-type":"application/json"}}}class W{constructor(t){this.stylesSource=t}getStylesSource(){return this.stylesSource}}const F=new h("StylesRegistry");class B{constructor(){this.stylesMap=new Map,this.stylesUrlMap=new Map,this.stylesQueueSize=0,this.callback=null}set(t,e,n){null!=n&&this.stylesUrlMap.set(t,n),this.stylesMap.set(t,e)}get(t){return this.stylesMap.get(t)}contains(t){return!!this.stylesMap.get(t)}done(t){this.callback=t,this.doCallback(this)}doCallback(t){if(null!==t.callback&&void 0!==t.callback&&t.stylesQueueSize===t.stylesMap.entries.length){var e=t.callback;t.callback=null,e.call()}}async load(t,e){this.stylesQueueSize++;const n=await D.get(e);if(!n.ok)throw"Unable to load styles for "+t+" at "+e;const i=await n.text();return this.set(t,new W(i),e),this.doCallback(this),null}async getStylesLoadedPromise(t){if(!t||0==t.size)return null;let e=[];const n=this;return t.forEach(((t,i)=>{if(n.contains(i))return!0;try{e.push(n.privateLoad(i,P.parse(t)))}catch(t){throw t}})),await Promise.all(e)}async privateLoad(t,e){F.info("Loading styles "+t+" at "+e.toString());const n=await D.get(e);if(!n.ok)throw"Unable to load styles for "+t+" at "+e;const i=await n.text(),s=new W(i);return this.set(t,s,e),s}}class q{constructor(t){this.templateSource=t}getTemplateSource(){return this.templateSource}}const G=new h("TemplateRegistry");class z{constructor(){this.templateMap=new Map,this.templateUrlMap=new Map,this.templateQueueSize=0,this.callback=null,this.languagePrefix=null}setLanguagePrefix(t){this.languagePrefix=t}set(t,e,n){null!=n&&this.templateUrlMap.set(t,n),this.templateMap.set(t,e)}get(t){return this.templateMap.get(t)}contains(t){return!!this.templateMap.get(t)}done(t){this.callback=t,this.doCallback(this)}doCallback(t){if(null!==tmo.callback&&void 0!==t.callback&&t.templateQueueSize===t.templateMap.size()){var e=t.callback;t.callback=null,e.call()}}async load(t,e){null!==this.languagePrefix&&e.pathsList.setLast(this.languagePrefix+"."+e.pathsList.getLast()),this.templateQueueSize++;const n=await D.get(e);if(!n.ok)throw"Unable to load template for "+t+" at "+e;const i=await n.text();this.set(t,new q(i),e),this.doCallback(this)}async getTemplatesLoadedPromise(t){if(!t||0==t.length)return null;let e=[];const n=this;return t.forEach(((t,i)=>{if(!n.contains(i))try{e.push(n.privateLoad(i,P.parse(t)))}catch(t){throw t}})),await Promise.all(e)}async privateLoad(t,e){null!==this.languagePrefix&&e.pathsList.setLast(this.languagePrefix+"."+e.pathsList.getLast()),G.info("Loading template "+t+" at "+e.toString());const n=await D.get(e);if(!n.ok)throw"Unable to load template for "+t+" at "+e;const i=await n.text(),s=new q(i);return this.set(t,s,e),s}}new h("TemplatePostConfig");class j{constructor(t){this.templateRegistry=t}load(t){let e=new Map;return t.forEach(((t,n)=>{t.classReference.TEMPLATE_URL&&e.set(t.classReference.name,t.classReference.TEMPLATE_URL)})),this.templateRegistry.getTemplatesLoadedPromise(e)}}new h("StylesLoader");class ${constructor(t){this.stylesRegistry=t}load(t){const e=new Map;return t.forEach(((t,n)=>(t.classReference.STYLES_URL&&e.set(t.classReference.name,t.classReference.STYLES_URL),!0)),this),this.stylesRegistry.getStylesLoadedPromise(e)}}new h("ComponentConfigProcessor");class Q{constructor(){this.templateRegistry=y.instance(z),this.stylesRegistry=y.instance(B)}postConfig(){this.templatesLoader=new j(this.templateRegistry),this.stylesLoader=new $(this.stylesRegistry)}processConfig(t,e){return Promise.all([this.templatesLoader.load(e),this.stylesLoader.load(e)])}}const Y=new h("LoaderInterceptor");class X{process(){return Y.info("Unimplemented Loader Interceptor breaks by default"),!1}}const J=new h("ModuleLoader");class K{constructor(t,e,n=[]){this.modulePath=t,this.trailStart=e,this.loaderInterceptors=n}matches(t){return!this.trailStart||(t?t.anchor?o.equals(this.trailStart,"/")?o.equals(t.anchor,this.trailStart):o.startsWith(t.anchor,this.trailStart):!!o.equals(this.trailStart,"/"):(J.error("Url is null"),!1))}async load(){try{const t=await this.importModule();return await this.interceptorsPass(),t}catch(t){return J.warn("Filter rejected "+t),null}}interceptorsPass(){const t=this.loaderInterceptors;if(t&&t.length>0){let e=t[0].process();for(let n=1;n<t.length;n++)e=e.then(t[n]);return e}return Promise.resolve()}async importModule(){try{return new((await import(this.modulePath)).default)}catch(t){throw t}}}class Z{constructor(){this.url=null,this.trailMap=null}async load(){throw"Module class must implement load()"}}const tt=new h("DiModuleLoader");class et extends K{constructor(t,e,n,i=[]){super(t,e,i),this.config=n}async load(){try{const t=await this.importModule();return await this.interceptorsPass(),await w.inject(t,this.config)}catch(t){throw tt.warn("Module loader failed "+t),t}}async importModule(){try{const t=await super.importModule();this.config.addAllTypeConfig(t.typeConfigArray),await this.config.finalize();const e=this.config;return await u.promiseChain(this.loaderInterceptors,(t=>w.inject(t,e))),t}catch(t){throw t}}}class nt{constructor(){this.objectMap=new Map,this.listeners=new Map,this.initialized=!1}react(t){const e="__ANY__";this.listeners.has(e)||this.listeners.set(e,new Array),this.listeners.get(e).push(t)}reactTo(t,e){this.listeners.has(t)||this.listeners.set(t,new Array),this.listeners.get(t).push(e)}get objectArray(){return Array.from(this.objectMap.values())}async update(t,e="__DEFAULT__"){if(Array.isArray(t))for(let n=0;n<t.length;n++)t[n]=this.createProxy(t[n],e,this);return t=this.createProxy(t,e,this),this.objectMap.set(e,t),this.initialized=!0,this.signalStateChange(t,e),t}async delete(t="__DEFAULT__"){this.objectMap.delete(t),this.listeners.delete(t),this.initialized=!0,this.signalStateChange(null,t)}async clear(){this.initialized=!0;for(let t of this.objectMap.keys())this.signalStateChange(null,t);this.signalStateChange(null,"__ANY__"),this.objectMap.clear(),this.listeners.clear(),this.initialized=!1}signalStateChange(t,e){if(this.listeners.has(e))for(let n of this.listeners.get(e))n.call([t,e]);const n="__ANY__";if(e!=n&&this.listeners.has(n))for(let i of this.listeners.get(n))i.call([t,e])}createProxy(t,e,n){return new Proxy(t,{set:(t,i,s)=>{if(t[i]===s)return!0;const r=t[i]=s;return n.signalStateChange(t,e),r===s}})}}class it{idAttributeWithSuffix(t){if(st.contains(t)){var e=st.get(t);return st.set(t,e+1),t+"-"+e}return st.set(t,1),t}}var st=new d;class rt{constructor(t){this.attribute=t}get value(){return this.attribute.value}get name(){return this.attribute.name}get namespace(){return this.attribute.name}}class at{constructor(t){if(!t)throw new Error("ContainerElement must be provided");this.containerElement=t}}const lt=new h("ElementUtils");class ot{static createContainerElement(t,e){return t instanceof M?ot.createFromXmlElement(t,e):"string"==typeof t?i.createElement(t):i.isUIElement(t)?new s(t):(lt.error("Unrecognized value for Element"),lt.error(t),null)}static createFromXmlElement(t,e){let n=null;return n=t.namespace?i.createElementNS(t.namespaceUri,t.fullName):i.createElement(t.name),e&&null!==e.containerElement&&e.containerElement.appendChild(n),t.attributes.forEach(((t,e)=>(i.setAttributeValue(n,t,e.value),!0))),n}}const ct=new h("BaseElement");class ht extends at{constructor(t,e){super(ot.createContainerElement(t,e)),this.attributeMap=null,this.eventsAttached=new c}loadAttributes(){if(null!==this.containerElement.attributes&&void 0!==this.containerElement.attributes){if(null===this.attributeMap||void 0===this.attributeMap){this.attributeMap=new d;for(var t=0;t<this.containerElement.attributes.length;t++)this.attributeMap.set(this.containerElement.attributes[t].name,new rt(this.containerElement.attributes[t]))}}else this.attributeMap=new d}listenTo(t,e,n,i=!1){const s=new p(e,n);return this.containerElement.addEventListener(t,s,i),this}get fullName(){return this.containerElement.tagName}get top(){return this.containerElement.boundingClientRect.top}get bottom(){return this.containerElement.boundingClientRect.bottom}get left(){return this.containerElement.boundingClientRect.left}get right(){return this.containerElement.boundingClientRect.right}get width(){return this.containerElement.offsetWidth}get height(){return this.containerElement.offsetHeight}get attributes(){return this.loadAttributes(),this.attributeMap}setAttributeValue(t,e){i.setAttributeValue(this.containerElement,t,e)}getAttributeValue(t){return i.getAttributeValue(this.containerElement,t)}containsAttribute(t){return this.containerElement.hasAttribute(t)}removeAttribute(t){this.containerElement.removeAttribute(t)}setStyle(t,e){this.containerElement.style[t]=e}getStyle(t){return this.containerElement.style[t]}removeStyle(t){this.containerElement.style[t]=null}set(t){if(!this.containerElement.parentNode)return void console.error("The element has no parent, can not swap it for value");const e=this.containerElement.parentNode;if(!t.containerElement)return t&&t.rootElement?(e.replaceChild(t.rootElement.containerElement,this.containerElement),void(this.containerElement=t.rootElement.containerElement)):void("string"!=typeof t?t instanceof Text||t instanceof Element?e.replaceChild(t,this.containerElement):(ct.warn("No valid input to set the element"),ct.warn(t)):e.replaceChild(i.createTextNode(t),this.containerElement));e.replaceChild(t.containerElement)}isMounted(){return!!this.containerElement.parentNode}remove(){if(this.containerElement.parentNode){this.containerElement.parentNode.removeChild(this.containerElement)}}clear(){for(;this.containerElement.firstChild;)this.containerElement.removeChild(this.containerElement.firstChild)}setChild(t){this.clear(),this.addChild(t)}addChild(t){if(void 0===t.containerElement||null===t.containerElement)if(t&&t.rootElement)this.containerElement.appendChild(t.rootElement.containerElement);else if("string"!=typeof t)if(t instanceof Text)this.containerElement.appendChild(t);else if(t instanceof Element){const e=new s(t);this.containerElement.appendChild(e)}else ct.warn("No valid input to add the element"),ct.warn(t);else this.containerElement.appendChild(i.createTextNode(t));else this.containerElement.appendChild(t.containerElement)}prependChild(t){null===this.containerElement.firstChild&&this.addChild(t),void 0===t.containerElement||null===t.containerElement?t&&t.rootElement?this.containerElement.insertBefore(t.rootElement.containerElement,this.containerElement.firstChild):"string"!=typeof t?t instanceof r||t instanceof Element?this.containerElement.insertBefore(t,this.containerElement.firstChild):(ct.warn("No valid input to prepend the element"),ct.warn(t)):this.containerElement.insertBefore(i.createTextNode(t),this.containerElement.firstChild):this.containerElement.insertBefore(t.containerElement,this.containerElement.firstChild)}}class ut{constructor(t,e,n){this.componentIndex=t,this.elementMap=n,this.rootElement=e}remove(){this.rootElement.remove()}get(t){return this.elementMap.get(t)}set(t,e){return this.elementMap.get(t).set(e),this.elementMap.get(t)}clearChildren(t){return this.elementMap.get(t).clear(),this.elementMap.get(t)}setChild(t,e){return this.elementMap.get(t).setChild(e),this.elementMap.get(t)}addChild(t,e){return this.elementMap.get(t).addChild(e),this.elementMap.get(t)}prependChild(t,e){return this.elementMap.get(t).prependChild(e),this.elementMap.get(t)}}new h("AbstractInputElement");class dt extends ht{constructor(t,e){super(t,e)}get name(){return this.containerElement.name}set name(t){this.containerElement.name=t}get value(){return this.backingValue}set value(t){this.containerElement.value=t,this.containerElement.dispatchEvent("change")}get backingValue(){return this.containerElement.value}focus(){this.containerElement.focus()}selectAll(){this.containerElement.select()}enable(){this.containerElement.disabled=!1}disable(){this.containerElement.disabled=!0}}class pt extends dt{constructor(t,e){super(t,e)}set checked(t){this.containerElement.checked=t}isChecked(){return this.containerElement.checked}get value(){return this.isChecked()}set value(t){this.containerElement.checked=!0===t||"true"===t}}class mt extends dt{constructor(t,e){super(t,e)}set checked(t){this.containerElement.checked=t}isChecked(){return this.containerElement.checked}get value(){return this.isChecked()}set value(t){this.containerElement.checked=!0===t||"true"===t}}class gt extends dt{constructor(t,e){super(t,e)}}class ft extends dt{constructor(t,e){super(t,e)}get innerHTML(){return this.containerElement.innerHTML}set innerHTML(t){this.containerElement.innerHTML=t}addChild(t){super.addChild(t),this.value=this.innerHTML}prependChild(t){super.prependChild(t),this.value=this.innerHTML}}class Et{constructor(t,e){this.containerElement=null,t instanceof x&&(this.containerElement=this.createFromXmlCdata(t,e)),"string"==typeof t&&(this.containerElement=i.createTextNode(t))}createFromXmlCdata(t,e){const n=i.createTextNode(t.value);return null!==e&&null!==e.containerElement&&e.containerElement.appendChild(n),n}set value(t){this.element=t}get value(){return this.element}}class yt extends ht{constructor(t,e){super(t,e)}get innerHTML(){return this.containerElement.innerHTML}set innerHTML(t){this.containerElement.innerHTML=t}focus(){this.containerElement.focus()}}class wt extends ht{constructor(t,e){super(t,e)}get name(){return this.containerElement.name}set name(t){this.containerElement.name=t}submit(){return this.containerElement.submit()}}class St extends ht{constructor(t,e){super(t,e)}get mappedElement(){return this.containerElement}playMuted(){this.containerElement.playMuted()}play(){this.containerElement.play()}mute(){this.containerElement.muted=!0}unmute(){this.containerElement.muted=!1}}class bt extends ht{constructor(t,e){super(t,e),this.optionLabel=null}get value(){return this.getAttributeValue("value")}set value(t){this.setAttributeValue("value",t)}get label(){return this.optionLabel}set label(t){this.optionLabel=t,this.setChild(t)}}class vt extends ht{constructor(t,e){super(t,e),this.optionsArray=[]}get options(){return this.optionsArray}set options(t){this.optionsArray=t,this.renderOptions()}renderOptions(){for(;this.containerElement.firstChild;)this.containerElement.removeChild(this.containerElement.firstChild);for(const t of this.optionsArray)this.containerElement.appendChild(t.containerElement)}get name(){return this.containerElement.name}set name(t){this.containerElement.name=t}get value(){return this.backingValue}get backingValue(){return this.containerElement.value}focus(){this.containerElement.focus()}selectAll(){this.containerElement.select()}enable(){this.containerElement.disabled=!1}disable(){this.containerElement.disabled=!0}}class At extends dt{constructor(t,e){super(t,e)}async focus(){LOG.WARN("File input elements cannot be focused directly due to browser security restrictions."),this.element.focus()}}class Tt{static map(t,e){return Tt.mapsToRadio(t)?new pt(t,e):Tt.mapsToCheckbox(t)?new mt(t,e):Tt.mapsToSubmit(t)?new gt(t,e):Tt.mapsToForm(t)?new wt(t,e):Tt.mapsToTextarea(t)?new ft(t,e):Tt.mapsToFile(t)?new At(t,e):Tt.mapsToText(t)?new gt(t,e):Tt.mapsToVideo(t)?new St(t,e):Tt.mapsToTextnode(t)?new Et(t,e):Tt.mapsToOption(t)?new bt(t,e):Tt.mapsToSelect(t)?new vt(t,e):(Tt.mapsToSimple(t)||console.log("Mapping to simple by default "+t),new yt(t,e))}static mapsToRadio(t){return t instanceof HTMLInputElement&&"radio"===t.type||!!(t instanceof M&&"input"===t.name&&t.getAttribute("type")&&"radio"===t.getAttribute("type").value)}static mapsToCheckbox(t){return t instanceof HTMLInputElement&&"checkbox"===t.type||!!(t instanceof M&&"input"===t.name&&t.getAttribute("type")&&"checkbox"===t.getAttribute("type").value)}static mapsToSubmit(t){return t instanceof HTMLInputElement&&"submit"===t.type||!!(t instanceof M&&"input"===t.name&&t.getAttribute("type")&&"submit"===t.getAttribute("type").value)}static mapsToForm(t){return t instanceof HTMLFormElement||t instanceof M&&"form"===t.name}static mapsToFile(t){return t instanceof HTMLInputElement&&"file"===t.type||!!(t instanceof M&&"input"===t.name&&t.getAttribute("type")&&"file"===t.getAttribute("type").value)}static mapsToText(t){if(t instanceof HTMLInputElement){if("text"===t.type)return!0;if("hidden"===t.type)return!0;if("number"===t.type)return!0;if("password"===t.type)return!0;if("email"===t.type)return!0;if("date"===t.type)return!0;if("time"===t.type)return!0}if(t instanceof M&&"input"===t.name){if(!t.getAttribute("type"))return!0;if("text"===t.getAttribute("type").value)return!0;if("hidden"===t.getAttribute("type").value)return!0;if("number"===t.getAttribute("type").value)return!0;if("password"===t.getAttribute("type").value)return!0;if("email"===t.getAttribute("type").value)return!0;if("date"===t.getAttribute("type").value)return!0;if("time"===t.getAttribute("type").value)return!0}return!1}static mapsToTextnode(t){return t instanceof Node&&"TEXT_NODE"===t.nodeType||t instanceof x}static mapsToOption(t){return t instanceof HTMLOptionElement||t instanceof M&&"option"===t.name}static mapsToSelect(t){return t instanceof HTMLSelectElement||t instanceof M&&"select"===t.name}static mapsToVideo(t){return t instanceof HTMLVideoElement||t instanceof M&&"video"===t.name}static mapsToTextarea(t){return t instanceof HTMLTextAreaElement||t instanceof M&&"textarea"===t.name}static mapsToSimple(t){return t instanceof HTMLElement||t instanceof M}}class Mt{constructor(t,e){this.componentIndex=e,this.uniqueIdRegistry=t,this.rootElement=null,this.elementMap=new d}getElementMap(){return this.elementMap}elementCreated(t,e){const n=Tt.map(t,e);return this.addToElementIdMap(n),null===this.rootElement&&null!==n&&(this.rootElement=n),n}addToElementIdMap(t){if(null!=t&&t instanceof ht){var e=null;t.containsAttribute("id")&&(e=t.getAttributeValue("id"),t.setAttributeValue("id",this.uniqueIdRegistry.idAttributeWithSuffix(e))),null!==e&&this.elementMap.set(e,t)}}}class xt{static shouldSwallowNextFocusEscape=!1;static mouseDownElement=null;static focusEscapeEventRequested=!1;static replaceComponent(t,e){const n=i.getElementById(t);n.parentNode.replaceChild(e.rootElement.containerElement,n)}static setComponent(t,e){const n=i.getElementById(t);n.innerHTML="",n.appendChild(e.rootElement.containerElement,n)}static addChildComponent(t,e){i.getElementById(t).appendChild(e.rootElement.containerElement)}static addChildElement(t,e){i.getElementById(t).appendChild(e.containerElement)}static removeElement(t){i.removeElement(t)}static addHeaderElement(t){i.appendRootMetaChild(t.containerElement)}static addBodyElement(t){i.appendRootUiChild(t.containerElement)}static prependHeaderElement(t){i.prependElement("head",t.containerElement)}static prependBodyElement(t){i.prependElement("body",t.containerElement)}static listenToFocusEscape(t,e,n){const s=new p(e,n),r=[];if(!xt.focusEscapeEventRequested){const t=new p((t=>{xt.mouseDownElement=t.target}));r.push(a.addEventListener("mousedown",t)),xt.focusEscapeEventRequested=!0}const l=new p((e=>{xt.mouseDownElement=e.target,i.contains(t.containerElement,xt.mouseDownElement)||i.isConnected(xt.mouseDownElement)&&(xt.shouldSwallowNextFocusEscape||s.call(e))}));return r.push(a.addEventListener("click",l)),()=>{r.forEach((t=>t()))}}static swallowFocusEscape(t){xt.shouldSwallowNextFocusEscape=!0,setTimeout((()=>{xt.shouldSwallowNextFocusEscape=!1}),t)}}class Ct{static custom(t,e=null){const n=new M(t);return e&&e.forEach(((t,e)=>{n.setAttribute(e,new C(e,null,t))})),Tt.map(n)}static applyStyles(t,e,n){e&&t.setAttributeValue("class",e),n&&t.setAttributeValue("style",n)}static a(t,e,n,i){const s=Ct.custom("a");return s.addChild(t),s.setAttributeValue("href",e),Ct.applyStyles(s,n,i),s}static i(t,e,n){const i=Ct.custom("i");return i.addChild(t),Ct.applyStyles(i,e,n),i}}const Rt=new h("CanvasStyles"),_t=new d,It=new d,Pt=new c;class Lt{static setStyle(t,e){if(_t.contains(t))_t.get(t).setChild(new Et(e.getStylesSource()));else{let n=Ct.custom("style");n.setAttributeValue("id",t),n.setChild(new Et(e.getStylesSource())),_t.set(t,n)}}static removeStyle(t){Pt.contains(t)&&(Pt.remove(t),xt.removeElement(t)),_t.contains(t)&&_t.remove(t)}static disableStyle(t,e=0){Lt.removeStyleOwner(t,e),Lt.hasStyleOwner(t)||(_t.contains(t)?Pt.contains(t)&&(Pt.remove(t),xt.removeElement(t)):Rt.error("Style does not exist: "+t))}static enableStyle(t,e=0){Lt.addStyleOwner(t,e),_t.contains(t)?Pt.contains(t)||(Pt.add(t),xt.addHeaderElement(_t.get(t))):Rt.error("Style does not exist: "+t)}static addStyleOwner(t,e){It.contains(t)||It.set(t,new c),It.get(t).contains(e)||It.get(t).add(e)}static removeStyleOwner(t,e){It.contains(t)&&It.get(t).remove(e)}static hasStyleOwner(t){return!!It.contains(t)&&It.get(t).size()>0}}class Nt{constructor(){}create(t){throw"Not implemented"}}const Ot=new h("TemplateComponentFactory");class Vt extends Nt{constructor(){super(),this.stylesRegistry=y.instance(B),this.templateRegistry=y.instance(z),this.uniqueIdRegistry=y.instance(it)}create(t){if(!t.TEMPLATE_URL)throw new Error("Template component class must implement static member TEMPLATE_URL");const e=this.templateRegistry.get(t.name);if(!e)throw Ot.error(this.templateRegistry),console.trace(),new Error("No template was found with name "+t.name);const n=new Mt(this.uniqueIdRegistry,Ht++);return new R(e.getTemplateSource(),n).load(),t.STYLES_URL&&this.mountStyles(t.name),new ut(n.componentIndex,n.rootElement,n.getElementMap())}mountStyles(t){this.stylesRegistry.contains(t)&&Lt.setStyle(t,this.stylesRegistry.get(t))}}let Ht=0;class Ut{static proceedAlongAnchor(t,e,n){const i=Ut.triggerFunctionsAlongAnchor(t,e,n);if(!i||0===i.length)return;const s=N.create().withAllOfUrl(L.currentUrl()),r=s.withAnchor(null).build();L.replaceUrl(r,r.toString(),null),i.forEach((t=>{const e=s.withAnchor(t).build();L.pushUrl(e,e.toString(),t)}))}static triggerFunctionsAlongAnchor(t,e,n,i=new Array){const s=i?i.join(""):"";return n.property&&(e=e[n.property]),o.startsWith(t.anchor,Ut.toStartsWith(n.trail))&&(i=u.add(i,n.trail),n.waypoint&&n.waypoint.call(e)),o.nonNullEquals(t.anchor,s+n.trail)&&(i=u.add(i,n.trail),n.destination&&n.destination.call(e)),n.next&&n.next.forEach((n=>{i=Ut.triggerFunctionsAlongAnchor(t,e,n,i)})),i}static proceedToDestinationFunction(t,e,n){const i=L.currentUrl(),s=Ut.getNodeTrailByFunction(n,t);if(0===s.length)return Promise.resolve();const r=t.call(e),a=Ut.concatinateSequenceAsAnchor(s);if(!o.nonNullEquals(i.anchor,a)){const t=N.create().withAllOfUrl(i).withAnchor(a).build();L.pushUrl(t,t.toString(),null)}return r}static jumpToDestinationFunction(t,e,n){const i=L.currentUrl(),s=Ut.getNodeTrailByFunction(n,t);if(0===s.length)return Promise.resolve();const r=t.call(e),a=Ut.concatinateSequenceAsAnchor(s);if(!o.nonNullEquals(i.anchor,a)){const t=N.create().withAllOfUrl(i).withAnchor(a).build();L.replaceUrl(t,t.toString(),null)}return r}static concatinateSequenceAsAnchor(t){return t.map((t=>t.trail)).join("")}static getNodeTrailByFunction(t,e,n=new Array,i=!0){return e===t.destination&&(n=u.add(n,t)),e!==t.destination&&0===n.length&&t.next&&t.next.forEach((t=>{0===n.length&&(n=Ut.getNodeTrailByFunction(t,e,n,!1))})),n.length>0&&(n=u.add(n,t)),i&&n.length>0?n.reverse():n}static toStartsWith(t){return null==t||o.nonNullEquals(t,"/")?"/":t+"/"}}class kt{constructor(t){this.className=t,this.attributes=new Map}withAttribute(t,e){return this.attributes.set(t,e),this}toString(){let t="";return this.attributes.forEach(((e,n)=>{t+=`\t${n}: ${e};\n`})),`${this.className} {\n${t}}`}}class Dt{constructor(t){this.media=t,this.styleSelectorArray=[]}withSelector(t){return this.styleSelectorArray.set(t),this}toString(){let t="";return this.styleSelectorArray.forEach((e=>{t+=`${e.toString()}\n`})),`${this.media} {\n${t}\n}\n`}}class Wt{static create(){return new Wt}constructor(){this.styleSelectorArray=[],this.mediaArray=[],this.lastAdded=null,this.context=null,this.parentContext=null}open(){if(!this.lastAdded)throw new Error("No context to open");return this.lastAdded&&(null!==this.context&&(this.parentContext=this.context),this.context=this.lastAdded),this}close(){if(null===this.context)throw new Error("No context to close");return this.context=this.parentContext,this.parentContext=null,this}selector(t){const e=new kt(t);if(null===this.context)this.styleSelectorArray.push(e);else{if(!(this.context instanceof Dt))throw new Error(`Open context must be a media context when adding ${t}`);this.context.styleSelectorArray.push(e)}return this.lastAdded=e,this}media(t){if(null!==this.context)throw new Error(`Cannot add media ${t} inside open context`);const e=new Dt(t);return this.mediaArray.push(e),this.lastAdded=e,this}style(t,e){if(!(this.context instanceof kt))throw new Error(`No open selector context when adding style ${t}`);return this.context.withAttribute(t,e),this}build(){let t="";return this.styleSelectorArray.forEach((e=>{t+=e.toString()+"\n"})),this.mediaArray.forEach((e=>{t+=e.toString()+"\n"})),new W(t)}}class Ft{static create(t){return new Ft(t)}constructor(t){this.idRegistry=t,this.elementMap=new Map,this.rootElement=null,this.lastAddedElement=null,this.contextElement=null,this.trail=[]}static tag(t,e,n,...i){const s=new Map;i.forEach((t=>{const[e,n]=t.split("=");s.set(e,n)}));const r=Ct.custom(n,s);return s.forEach(((n,i)=>{"id"===i&&(e.set(n,r),n=t.idAttributeWithSuffix(n)),r.setAttributeValue(i,n)})),r}root(t,...e){if(this.rootElement)throw new Error("ComponentBuilder: Root element is already defined.");return this.rootElement=Ft.tag(this.idRegistry,this.elementMap,t,...e),this.lastAddedElement=this.rootElement,this.contextElement=this.rootElement,this}node(t,...e){if(!this.rootElement)throw new Error("ComponentBuilder: Root element is not defined. Call root() before adding child elements.");if(0===this.trail.length)throw new Error("ComponentBuilder: No open element context to add child elements, call open() before adding.");const n=Ft.tag(this.idRegistry,this.elementMap,t,...e);return this.contextElement.addChild(n),this.lastAddedElement=n,this}text(t){if(!this.rootElement)throw new Error("ComponentBuilder: Root element is not defined. Call root() before adding child elements.");if(0===this.trail.length)throw new Error("ComponentBuilder: No open element context to add child elements, call open() before adding.");return this.contextElement.addChild(t),this.lastAddedElement=null,this}open(){if(!this.rootElement)throw new Error("ComponentBuilder: Root element is not defined. Call root() before adding child elements.");if(null===this.lastAddedElement)throw new Error("ComponentBuilder: Unable to open last element.");return this.trail.push(this.contextElement),this.contextElement=this.lastAddedElement,this}close(){if(0===this.trail.length)throw new Error("ComponentBuilder: No open element context to close.");return this.contextElement=this.trail.pop(),this.lastAddedElement=this.contextElement,this}build(){return new ut(Bt++,this.rootElement,this.elementMap)}}let Bt=0;class qt extends Nt{constructor(){super(),this.stylesRegistry=y.instance(B),this.uniqueIdRegistry=y.instance(it)}create(t){if(!t.buildComponent)throw new Error("Inline component class must implement static method buildComponent()");const e=t.buildComponent(Ft.create(this.uniqueIdRegistry));if(t.buildStylesheet){const e=t.buildStylesheet(Wt.create());Lt.setStyle(t.name,e)}return e}}const Gt=new h("Application");class zt extends _{constructor(t,e=new A,n=new Array){super(),this.moduleLoaderArray=t,this.config=e,this.workerArray=n,this.runningWorkers=new Array,this.activeModule=null,this.defaultConfig=[S.unnamed(z),S.unnamed(B),S.unnamed(it),S.unnamed(Vt),S.unnamed(qt),b.unnamed(nt)],this.defaultConfigProcessors=[Q],this.defaultInstanceProcessors=[v]}async run(){Gt.info("Running Application"),this.config.addAllTypeConfig(this.defaultConfig).addAllConfigProcessor(this.defaultConfigProcessors).addAllInstanceProcessor(this.defaultInstanceProcessors),k.instance().set(this),t.addUserNavigateListener(new p(this.update,this));const e=await this.runModule(L.currentUrl());return this.startWorkers(),e}update(t){const e=L.currentUrl();this.activeModule&&this.activeModule.trailMap&&o.startsWith(e.anchor,this.activeModule.trailMap.trail)?Ut.triggerFunctionsAlongAnchor(e,this.activeModule,this.activeModule.trailMap):this.runModule(e)}async runModule(t){try{const e=this.getMatchingModuleLoader(t);return this.activeModule=await e.load(),this.activeModule.url=t,this.activeModule.load(),this.activeModule.trailMap&&Ut.triggerFunctionsAlongAnchor(t,this.activeModule,this.activeModule.trailMap),this.activeModule}catch(t){return Gt.error(t),null}}startWorkers(){if(this.runningWorkers.length>0)return;const t=this.config,e=this.runningWorkers;this.workerArray.forEach((n=>{const i=new n;w.inject(i,t),u.add(e,i)}))}getMatchingModuleLoader(t){let e=null;return this.moduleLoaderArray.forEach((n=>{!e&&n.matches(t)&&(e=n)})),e}windowDiConfig(){window.diConfig=()=>{Gt.info(this.config.configEntries)}}windowTemplateRegistry(){window.templateRegistry=()=>{const t=T.typeConfigByName(z.name,this.config);Gt.info(t.instanceHolder().instance)}}windowStyleRegistry(){window.styleRegistry=()=>{const t=T.typeConfigByName(B.name,this.config);Gt.info(t.instanceHolder().instance)}}}let jt=new d;class $t{static configure(t,e){jt.set(t,e)}static execute(t,e){return jt.get(t).call(null,e)}}new h("InputElementDataBinding");class Qt{constructor(t,e){this.model=t,this.validator=e,this.pullers=new c,this.pushers=new c}static link(t,e){return new Qt(t,e)}and(t){return this.to(t)}to(t){const e=()=>{m.getValue(this.model,t.name)!==t.value&&m.setValue(this.model,t.name,t.value),this.validator&&this.validator.validate&&this.validator.validate(t.value)};t.listenTo("change",e,this),t.listenTo("keyup",e,this),e.call();let n="__changed_"+t.name.replace(".","_");return this.model[n]||(this.model[n]=()=>{this.push()}),this.pullers.add(e),this.pushers.add((()=>{var e=m.getValue(this.model,t.name);e!==t.value&&(t.value=e),this.validator&&this.validator.validateSilent&&t.value&&this.validator.validateSilent(t.value)})),this}pull(){this.pullers.forEach(((t,e)=>(t.call(e),!0)),this)}push(){this.pushers.forEach(((t,e)=>(t.call(e),!0)),this)}}class Yt{static createProxyObject(t){return new Proxy(t,{set:(t,e,n)=>{let i=t[e]=n,s=t["__changed_"+e];if(s&&"function"==typeof s){s.bind(t)()}return i===n}})}}class Xt{constructor(t){this.event=t,"dragstart"==this.event.type.toLowerCase()&&this.event.dataTransfer.setData("text/plain",null)}stopPropagation(){this.event.stopPropagation()}preventDefault(){this.event.preventDefault()}get files(){if(this.event.target&&this.event.target.files)return this.event.target.files;if(this.event.dataTransfer){const t=this.event.dataTransfer;if(t.files)return t.files}return[]}get offsetX(){return this.event.offsetX}get offsetY(){return this.event.offsetY}get clientX(){return this.event.clientX}get clientY(){return this.event.clientY}get target(){if(this.event&&this.event.target)return $t.execute("mapElement",this.event.target)}get relatedTarget(){return this.event&&this.event.relatedTarget?$t.execute("mapElement",this.event.relatedTarget):null}getRelatedTargetAttribute(t){return this.event.relatedTarget?$t.execute("mapElement",this.event.relatedTarget).getAttributeValue(t):null}get targetValue(){return this.target?this.target.value:null}get keyCode(){return this.event.keyCode}isKeyCode(t){return this.event.keyCode===t}}class Jt extends p{constructor(t,e){this.method=t,this.filter=e}call(t){this.filter&&this.filter.call(this,t)&&this.method.call(t)}}const Kt=new h("EventManager");class Zt{constructor(){this.listenerMap=new d}listenTo(t,e,n){const i=new p(e,n);return this.listenerMap.contains(t)||this.listenerMap.set(t,new c),this.listenerMap.get(t).add(i),this}async trigger(t,e){if(!t)return void Kt.error("Event type is undefined");if(!this.listenerMap.contains(t))return;let n=[];return this.listenerMap.get(t).forEach(((t,i)=>(n.push(t.call(e)),!0))),1===n.length?n[0]:Promise.all(n)}}class te{static from(t){return new te(t)}constructor(t){this.baseElement=t}clear(){return this.baseElement.setAttributeValue("style",""),this}remove(t){const e=this.stylesAsMap(this.baseElement.getAttributeValue("style"));return e.contains(t)&&e.remove(t),this.baseElement.setAttributeValue("style",g.toString(e,":",";")),this}set(t,e){const n=this.stylesAsMap(this.baseElement.getAttributeValue("style"));return n.set(t,e),this.baseElement.setAttributeValue("style",g.toString(n,":",";")),this}is(t,e){const n=this.stylesAsMap(this.baseElement.getAttributeValue("style"));return o.nonNullEquals(n.get(t),e)}exists(t){return this.stylesAsMap(this.baseElement.getAttributeValue("style")).contains(t)}stylesAsMap(t){if(!t||-1===t.indexOf(":"))return new d;const e=new d;return new c(o.toArray(t,";")).forEach(((t,n)=>{if(!t||-1===t.indexOf(":"))return;const i=t.split(":")[0].trim(),s=t.split(":")[1].trim();return e.set(i,s),!0}),this),e}}class ee{static from(t){return new ee(t)}constructor(t){this.baseElement=t}clear(){return this.baseElement.setAttributeValue("class",""),this}toggle(t){let e=this.baseElement.getAttributeValue("class"),n=o.toArray(e," "),i=new c(n);return i.contains(t)?i.remove(t):i.add(t),this.baseElement.setAttributeValue("class",u.toString(i.getArray()," ")),this}enable(t){let e=this.baseElement.getAttributeValue("class"),n=o.toArray(e," "),i=new c(n);return i.contains(t)||i.add(t),this.baseElement.setAttributeValue("class",u.toString(i.getArray()," ")),this}disable(t){let e=this.baseElement.getAttributeValue("class"),n=o.toArray(e," "),i=new c(n);return i.contains(t)&&i.remove(t),this.baseElement.setAttributeValue("class",u.toString(i.getArray()," ")),this}replace(t,e){let n=this.baseElement.getAttributeValue("class"),i=o.toArray(n," "),s=new c(i),r=[];return o.isBlank(t)||s.forEach((e=>(e.startsWith(t)&&r.push(e),!0)),this),r.forEach((t=>{s.remove(t)})),s.add(e),this.baseElement.setAttributeValue("class",u.toString(s.getArray()," ")),this}}new h("HttpCallBuilder");class ne{constructor(t){this.url=t,this.authorization=null,this.successMappingMap=new d,this.failMappingMap=new d,this.errorMappingFunction=t=>t,this.connectionTimeoutValue=4e3,this.responseTimeoutValue=4e3,this.progressCallbackMethod=null,this.downloadResponse=!1}static newInstance(t){return new ne(t)}successMapping(t,e=()=>null){return this.successMappingMap.set(t,e),this}asDownload(){return this.downloadResponse=!0,this}failMapping(t,e=()=>null){return this.failMappingMap.set(t,e),this}errorMapping(t){return this.errorMappingFunction=t,this}authorizationHeader(t){return o.isBlank(t)||(this.authorization="Bearer "+t),this}progressCallback(t){return this.progressCallbackMethod=t,this}connectionTimeout(t){return this.connectionTimeoutValue=t,this}responseTimeout(t){return this.responseTimeoutValue=t,this}async get(){const t=D.get(this.url,this.authorization,this.connectionTimeoutValue,this.downloadResponse);return this.asTypeMappedPromise(t)}async post(t){const e=await D.post(this.url,t,this.authorization,this.progressCallbackMethod,this.connectionTimeoutValue);return this.asTypeMappedPromise(e)}async put(t){const e=await D.put(this.url,t,this.authorization,this.progressCallbackMethod,this.connectionTimeoutValue);return this.asTypeMappedPromise(e)}async patch(t){const e=await D.patch(this.url,t,this.authorization,this.progressCallbackMethod,this.connectionTimeoutValue);return this.asTypeMappedPromise(e)}async delete(t=null){const e=await D.delete(this.url,t,this.authorization,this.progressCallbackMethod,this.connectionTimeoutValue);return this.asTypeMappedPromise(e)}async asTypeMappedPromise(t){try{const e=await t;return e instanceof l?e:await this.handleFetchResponse(e)}catch(t){throw this.errorMappingFunction(t)}}async handleFetchResponse(t){const e=this.successMappingMap.get(t.status),n=this.failMappingMap.get(t.status);if(204===t.status||"0"===t.headers.get("Content-Length")){if(e)return e(null);if(n)throw n(null);throw new Error("Missing mapper for return status: "+t.status)}try{const i=await t.json();if(e)return e(i);if(n)throw n(i);throw this.errorMappingFunction(i)}catch(t){throw this.errorMappingFunction(t)}}}class ie{constructor(){this.params=new Map}static create(){return new ie}withString(t,e){return this.params.set(t,e),this}withArray(t,e){return this.params.set(t,e),this}build(){let t="",e=!0;return this.params.forEach(((n,i)=>{Array.isArray(n)?n.forEach((n=>{e?e=!1:t+="&",t+=encodeURIComponent(i)+"="+encodeURIComponent(n)})):(e?e=!1:t+="&",t+=encodeURIComponent(i)+"="+encodeURIComponent(n))})),t}}class se{static async sha256B64(t){const e=(new TextEncoder).encode(t),n=await crypto.subtle.digest("SHA-256",e),i=Array.from(new Uint8Array(n));return btoa(String.fromCharCode(...i))}}const re=new h("AbstractValidator");class ae{constructor(t=!1,e=!0){this.validListenerList=new c,this.invalidListenerList=new c,this.currentlyValid=t,this.enabled=e}enable(){this.enabled=!0,this.isValid()?this.valid():this.invalid()}disable(){let t=this.currentlyValid;this.valid(),this.enabled=!1,this.currentlyValid=t}isValid(){return!this.enabled||this.currentlyValid}valid(){this.enabled&&(this.currentlyValid=!0,this.validListenerList?this.validListenerList.forEach(((t,e)=>(t.call(),!0)),this):re.warn("No validation listeners"))}invalid(){this.enabled&&(this.currentlyValid=!1,this.invalidListenerList?this.invalidListenerList.forEach(((t,e)=>(t.call(),!0)),this):re.warn("No invalidation listeners"))}validSilent(){this.currentlyValid=!0}invalidSilent(){this.currentlyValid=!1}withValidListener(t){return this.validListenerList.add(t),this}withInvalidListener(t){return this.invalidListenerList.add(t),this}}class le extends ae{constructor(t=!1){super(t),this.validatorList=new c}withValidator(t){return t.withValidListener(new p(this.oneValid,this)),t.withInvalidListener(new p(this.oneInvalid,this)),this.validatorList.add(t),this}oneValid(){let t=!1;this.validatorList.forEach(((e,n)=>!!e.isValid()||(t=!0,!1)),this),t?super.invalid():super.valid()}oneInvalid(){super.invalid()}}class oe extends ae{constructor(t=!1,e=!1,n="(.*)"){super(e),this.mandatory=t,this.regex=n}validate(t){t&&"string"==typeof t&&t.match(this.regex)?this.valid():t||this.mandatory?this.invalid():this.valid()}validateSilent(t){t&&"string"==typeof t&&t.match(this.regex)?this.validSilent():t||this.mandatory?this.invalidSilent():this.validSilent()}}class ce extends oe{static EMAIL_FORMAT=/^\w+([\.-]?\w+)*@\w+([\.-]?\w+)*(\.\w{2,3})+$/;constructor(t=!1,e=!1){super(t,e,ce.EMAIL_FORMAT)}}class he extends ae{constructor(t=!1,e=!1,n=null){super(e),this.mandatory=t,this.comparedValueFunction=n}validate(t){!t&&this.mandatory?this.invalid():t===this.comparedValueFunction.call()?this.valid():this.invalid()}validateSilent(t){!t&&this.mandatory?this.invalidSilent():t===this.comparedValueFunction.call()?this.validSilent():this.invalidSilent()}}class ue extends ae{constructor(t=!1,e=!1,n=null,i=null){super(e),this.mandatory=t,this.model=n,this.attributeName=i}validate(t){!t&&this.mandatory?this.invalid():t===m.getValue(this.model,this.attributeName)?this.valid():this.invalid()}validateSilent(t){!t&&this.mandatory?this.invalidSilent():t===m.getValue(this.model,this.attributeName)?this.validSilent():this.invalidSilent()}}class de extends ae{constructor(t=!1,e=!1,n=null){super(e),this.mandatory=t,this.controlValue=n}validate(t){!t&&this.mandatory?this.invalid():t===controlValue?this.valid():this.invalid()}validateSilent(t){!t&&this.mandatory?this.invalidSilent():t===controlValue?this.validSilent():this.invalidSilent()}}class pe extends oe{static PHONE_FORMAT=/^\d*$/;constructor(t=!1,e=!1){super(t,e,pe.PHONE_FORMAT)}}class me extends ae{constructor(t=!1){super(t),this.validatorList=new c}withValidator(t){return t.withValidListener(new p(this.oneValid,this)),t.withInvalidListener(new p(this.oneInvalid,this)),this.validatorList.add(t),this}oneValid(){super.valid()}oneInvalid(){let t=!1;this.validatorList.forEach(((e,n)=>!e.isValid()||(t=!0,!1)),this),t?super.valid():super.invalid()}}const ge=/^(?=.*[A-Za-z])(?=.*?[0-9])(?=.*?[#?!@$%^&*-]).{8,}$/;class fe extends oe{constructor(t=!1,e=!1){super(t,e,ge)}}class Ee extends oe{static PHONE_FORMAT=/^\+[0-9]{2}\s?([0-9]\s?)*$/;constructor(t=!1,e=!1){super(t,e,Ee.PHONE_FORMAT)}}class ye extends ae{constructor(t=!1,e=!0){super(t,e)}validate(t){""===t?this.invalid():this.valid()}validateSilent(t){""===t?this.invalidSilent():this.validSilent()}}class we{static ID_SPACE_STRING_WIDTH=17;static HW_STRING_PART_WIDTH=9;static EPOCH_SECONDS_STRING_PART_WIDTH=6;static COUNT_STRING_PART_WIDTH=2;constructor(t=null,e=null,n=null){this.mac=t,this.epochSeconds=e,this.counter=n}static parse(t){if(null==t||t.length<we.ID_SPACE_STRING_WIDTH||!f.isValidRadixString(t))throw Error("ID Space must be at least "+we.ID_SPACE_STRING_WIDTH+" characters long and contain valid characters.");const e=t.substring(0,we.HW_STRING_PART_WIDTH),n=t.substring(we.HW_STRING_PART_WIDTH,we.HW_STRING_PART_WIDTH+we.EPOCH_SECONDS_STRING_PART_WIDTH),i=t.substring(we.HW_STRING_PART_WIDTH+we.EPOCH_SECONDS_STRING_PART_WIDTH,we.HW_STRING_PART_WIDTH+we.EPOCH_SECONDS_STRING_PART_WIDTH+we.COUNT_STRING_PART_WIDTH),s=f.fromRadixString(e),r=f.fromRadixString(n),a=f.fromRadixString(i);return new we(s,r,a)}toString(){return o.leftPad(f.toRadixString(this.mac),we.HW_STRING_PART_WIDTH,"0")+o.leftPad(f.toRadixString(this.epochSeconds),we.EPOCH_SECONDS_STRING_PART_WIDTH,"0")+o.leftPad(f.toRadixString(this.counter),we.COUNT_STRING_PART_WIDTH,"0")}report(){const t=new Map;return t.set("IdSpace [MAC]",E.toMacAddress(this.mac)),t.set("IdSpace [Epoch]",1e3*this.epochSeconds),t.set("IdSpace [Date]",new Date(1e3*this.epochSeconds).toISOString()),t.set("IdSpace [Counter]",this.counter),t}}class Se{static USER_ID_STRING_WIDTH=9;static EPOCH_CENTIS_STRING_PART_WIDTH=7;static COUNT_STRING_PART_WIDTH=2;constructor(t=null,e=null){this.epochCentis=t,this.counter=e}static parse(t){if(null==t||t.length!==Se.USER_ID_STRING_WIDTH||!f.isValidRadixString(t))throw new Error("User ID must be at least "+Se.USER_ID_STRING_WIDTH+" characters long and contain valid characters.");const e=f.fromRadixString(t.substring(0,Se.EPOCH_CENTIS_STRING_PART_WIDTH)),n=f.fromRadixString(t.substring(Se.EPOCH_CENTIS_STRING_PART_WIDTH,Se.USER_ID_STRING_WIDTH));return new Se(e,n)}toString(){return o.leftPad(f.toRadixString(this.epochCentis),Se.EPOCH_CENTIS_STRING_PART_WIDTH,"0")+o.leftPad(f.toRadixString(this.counter),Se.COUNT_STRING_PART_WIDTH,"0")}report(){const t=new Map;return t.set("UserId [Epoch]",10*this.epochCentis),t.set("UserId [Date]",new Date(10*this.epochCentis).toISOString()),t.set("UserId [Counter]",this.counter),t}}const be=new h("Id");class ve{constructor(t=null,e=null){this.idSpace=t,this.userId=e}static parse(t){const e=t.substring(0,we.ID_SPACE_STRING_WIDTH),n=t.substring(we.ID_SPACE_STRING_WIDTH),i=we.parse(e),s=Se.parse(n);return new ve(i,s)}report(){const t=new Map,e=this.idSpace.report();for(const[n,i]of e.entries())t.set(n,i);const n=this.userId.report();for(const[e,i]of n.entries())t.set(e,i);return t}reportString(){const t=this.report();let e="",n=!0;for(const[i,s]of t.entries())e+=n?i+": "+s:"\n"+i+": "+s,n=!1;return e}print(){be.info(this.reportString())}toString(){return idSpace.toString()+userId.toString()}userId(){return userId.toString()}}export{dt as AbstractInputElement,ae as AbstractValidator,k as ActiveModuleRunner,le as AndValidatorSet,zt as Application,rt as Attribute,ht as BaseElement,xt as CanvasRoot,Lt as CanvasStyles,mt as CheckboxInputElement,D as Client,ut as Component,Ft as ComponentBuilder,Q as ComponentConfigProcessor,Nt as ComponentFactory,$t as ConfiguredFunction,et as DiModuleLoader,Tt as ElementMapper,Mt as ElementRegistrator,ot as ElementUtils,ce as EmailValidator,he as EqualsFunctionResultValidator,ue as EqualsPropertyValidator,de as EqualsStringValidator,Xt as Event,Jt as EventFilteredMethod,Zt as EventManager,At as FileInputElement,wt as FormElement,Ct as HTML,L as History,ne as HttpCallBuilder,ve as Id,we as IdSpace,qt as InlineComponentFactory,Qt as InputElementDataBinding,X as LoaderInterceptor,at as MappedContainerElement,Z as Module,K as ModuleLoader,_ as ModuleRunner,V as Navigation,pe as NumberValidator,bt as OptionElement,me as OrValidatorSet,fe as PasswordValidator,Ee as PhoneValidator,Yt as ProxyObjectFactory,ie as QueryParamBuilder,pt as RadioInputElement,oe as RegexValidator,ye as RequiredValidator,vt as SelectElement,se as ShaUtils,yt as SimpleElement,nt as StateManager,te as StyleAccessor,Dt as StyleMedia,kt as StyleSelector,ee as StyleSelectorAccessor,$ as StylesLoader,B as StylesRegistry,W as Stylesheet,Wt as StylesheetBuilder,q as Template,Vt as TemplateComponentFactory,z as TemplateRegistry,j as TemplatesLoader,gt as TextInputElement,ft as TextareaInputElement,Et as TextnodeElement,H as TrailNode,Ut as TrailProcessor,it as UniqueIdRegistry,I as Url,N as UrlBuilder,P as UrlUtils,Se as UserId,St as VideoElement};
